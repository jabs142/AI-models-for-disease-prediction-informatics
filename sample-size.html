<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Training Data Size & Model Performance</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: #f5f7fa;
    color: #2c3e50;
    margin: 0;
    padding: 20px;
  }
  .container {
    max-width: 900px;
    margin: 0 auto;
  }
  h1 {
    font-size: 1.6em;
    margin-bottom: 0.4em;
    color: #1a1a1a;
  }
  .subtitle {
    color: #666;
    font-size: 0.95em;
    margin-bottom: 35px;
    line-height: 1.6;
  }

  .card {
    background: white;
    border-radius: 10px;
    padding: 30px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    margin-bottom: 30px;
  }

  .card-header {
    font-weight: 600;
    font-size: 1.1em;
    margin-bottom: 25px;
    color: #1a1a1a;
  }

  #learningCurve {
    height: 300px;
    position: relative;
    margin-bottom: 25px;
  }

  canvas {
    width: 100%;
    height: 100%;
  }

  .controls {
    margin: 25px 0;
  }

  .slider-container {
    margin: 20px 0;
  }

  .slider-label {
    display: flex;
    justify-content: space-between;
    font-size: 0.9em;
    color: #666;
    margin-bottom: 10px;
  }

  input[type=range] {
    width: 100%;
  }

  .metrics-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-top: 25px;
  }

  .metric-box {
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
    text-align: center;
  }

  .metric-value {
    font-size: 2em;
    font-weight: bold;
    color: #2c3e50;
  }

  .metric-label {
    font-size: 0.85em;
    color: #666;
    margin-top: 8px;
  }

  .insight-box {
    padding: 20px;
    border-radius: 8px;
    margin-top: 20px;
    border-left: 4px solid #3498db;
    background: #e3f2fd;
    font-size: 0.95em;
    line-height: 1.6;
  }

  .back-button {
    display: inline-block;
    margin-bottom: 25px;
    padding: 10px 20px;
    background: #3498db;
    color: white;
    text-decoration: none;
    border-radius: 6px;
    font-size: 0.9em;
    font-weight: 500;
    transition: background 0.2s;
  }
  .back-button:hover {
    background: #2980b9;
  }

  /* Collapsible Section Styling */
  .collapsible-section {
    margin: 40px 0;
  }

  .collapsible-toggle {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: 15px 20px;
    background: white;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 0.95em;
    font-weight: 600;
    color: #495057;
    cursor: pointer;
    transition: all 0.2s;
    text-align: left;
  }
  .collapsible-toggle:hover {
    border-color: #3498db;
    color: #3498db;
    background: #f8f9fa;
  }

  .collapsible-arrow {
    font-size: 1.1em;
    transition: transform 0.2s;
    color: #3498db;
  }
  .collapsible-arrow.open {
    transform: rotate(90deg);
  }

  .collapsible-content {
    display: none;
    background: white;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 30px;
    margin-top: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  }
  .collapsible-content.visible {
    display: block;
  }

  .deep-dive-content h3 {
    color: #2c3e50;
    margin-top: 25px;
    margin-bottom: 12px;
    font-size: 1.05em;
  }
  .deep-dive-content p {
    margin-bottom: 1em;
    color: #495057;
    line-height: 1.7;
  }
  .deep-dive-content ul {
    padding-left: 25px;
    margin-bottom: 1em;
    line-height: 1.6;
  }
  .deep-dive-content li {
    margin-bottom: 6px;
  }

  .key-takeaway {
    background: #e8f5e9;
    padding: 18px 20px;
    border-left: 4px solid #28a745;
    border-radius: 6px;
    margin-top: 25px;
  }

  .prompt-text {
    color: #495057;
    font-size: 0.95em;
    line-height: 1.7;
  }
</style>
</head>
<body>

<div class="container">
  <a href="index.html" class="back-button">‚Üê Back to Home</a>
  <h1>üìä Training Data Size & Model Performance</h1>
  <div class="subtitle">
    <strong>What this teaches:</strong> More training data leads to better AI model performance and more reliable predictions. Watch how accuracy improves and uncertainty decreases as training set size increases.<br>
    <strong>Why it matters:</strong> Understanding the sample size needed for reliable AI models is critical for safe deployment in healthcare.
  </div>

  <div class="card">
    <div class="card-header">Learning Curve: Performance vs. Training Set Size</div>

    <canvas id="learningCurve"></canvas>

    <div class="controls">
      <div class="slider-container">
        <div class="slider-label">
          <span>100 patients</span>
          <span><strong id="currentSize">1,000</strong> training patients</span>
          <span>10,000 patients</span>
        </div>
        <input type="range" id="sizeSlider" min="100" max="10000" step="100" value="1000">
      </div>
    </div>

    <div class="metrics-grid">
      <div class="metric-box">
        <div class="metric-value" id="accuracyValue">82.5%</div>
        <div class="metric-label">Model Accuracy</div>
      </div>
      <div class="metric-box">
        <div class="metric-value" id="ciValue">¬±4.2%</div>
        <div class="metric-label">95% Confidence Interval</div>
      </div>
      <div class="metric-box">
        <div class="metric-value" id="reliabilityText">Moderate</div>
        <div class="metric-label">Reliability</div>
      </div>
    </div>

    <div class="insight-box" id="insightBox">
      With 1,000 training samples, the model achieves moderate performance. More data will improve accuracy and reduce uncertainty.
    </div>
  </div>

  <!-- COLLAPSIBLE: TECHNICAL DEEP DIVE -->
  <div class="collapsible-section">
    <button class="collapsible-toggle" onclick="toggleDeepDive()">
      <span>üìö Technical Deep Dive: Sample Size & Statistical Learning</span>
      <span class="collapsible-arrow" id="deepDiveArrow">‚Ä∫</span>
    </button>

    <div class="collapsible-content deep-dive-content" id="deepDiveContent">
      <h3>The Learning Curve Phenomenon</h3>
      <p>
        This demo visualizes the <strong>learning curve</strong>‚Äîa fundamental concept in machine learning showing how model performance improves with more training data. As sample size increases, two critical things happen: accuracy rises and uncertainty (variance) decreases.
      </p>

      <h3>Why More Data Improves Performance</h3>
      <p><strong>Small training sets (100-500 patients):</strong></p>
      <ul>
        <li>Model has limited examples to learn from</li>
        <li>High risk of overfitting (memorizing training data instead of learning patterns)</li>
        <li>Poor generalization to new patients</li>
        <li>Wide confidence intervals (¬±6-8%)</li>
      </ul>

      <p><strong>Medium training sets (1,000-3,000 patients):</strong></p>
      <ul>
        <li>Model learns more robust patterns</li>
        <li>Better balance between bias and variance</li>
        <li>Improved generalization</li>
        <li>Moderate confidence intervals (¬±3-5%)</li>
      </ul>

      <p><strong>Large training sets (5,000+ patients):</strong></p>
      <ul>
        <li>Model captures complex patterns reliably</li>
        <li>Low overfitting risk</li>
        <li>Strong generalization to unseen data</li>
        <li>Narrow confidence intervals (¬±1-2%)</li>
      </ul>

      <h3>The Math: Confidence Intervals Shrink with ‚àön</h3>
      <p>
        The confidence interval (uncertainty in accuracy estimate) follows:
      </p>
      <p style="background: #f8f9fa; padding: 12px; border-radius: 5px; font-family: monospace; text-align: center;">
        CI ‚àù 1/‚àön
      </p>
      <p>
        This means <strong>quadrupling your training data halves your uncertainty</strong>. Going from 1,000 to 4,000 samples reduces CI from ¬±4.2% to ¬±2.1%.
      </p>

      <h3>Diminishing Returns</h3>
      <p>
        Notice how the accuracy curve flattens at high sample sizes. The biggest gains come from 100‚Üí1,000 patients. Beyond 5,000, additional data provides smaller improvements. This is why we see:
      </p>
      <ul>
        <li><strong>100 patients:</strong> 68% accuracy (dangerously low)</li>
        <li><strong>1,000 patients:</strong> 82.5% accuracy (+14.5% gain)</li>
        <li><strong>5,000 patients:</strong> 91% accuracy (+8.5% gain)</li>
        <li><strong>10,000 patients:</strong> 93% accuracy (+2% gain)</li>
      </ul>
      <p>
        The cost-benefit analysis suggests 2,000-5,000 samples is the "sweet spot" for most healthcare models‚Äîenough data for reliable performance without excessive collection costs.
      </p>

      <h3>Overfitting vs. Underfitting</h3>
      <p>
        With <strong>too little data</strong>, models overfit (memorize noise). With <strong>too much data relative to model complexity</strong>, gains plateau. The ideal is sufficient data to capture true patterns without diminishing returns.
      </p>

      <h3>Real-World Application</h3>
      <p>
        When planning AI deployment in healthcare:
      </p>
      <ul>
        <li>Minimum 500-1,000 samples for initial training</li>
        <li>Target 2,000-5,000 for production deployment</li>
        <li>Continue collecting data for model updates</li>
        <li>Always report confidence intervals alongside accuracy</li>
      </ul>

      <div class="key-takeaway">
        <strong>Key Takeaway:</strong> More training data improves model accuracy and reduces uncertainty. For healthcare AI, aim for thousands of diverse patient examples, not hundreds. The ‚àön relationship means diminishing returns beyond a certain point, so target the sample size that balances performance with collection costs.
      </div>
    </div>
  </div>

  <!-- COLLAPSIBLE: VIEW PROMPT -->
  <div class="collapsible-section">
    <button class="collapsible-toggle" onclick="togglePrompt()">
      <span>üìã View Prompt Used to Generate This Demo</span>
      <span class="collapsible-arrow" id="promptArrow">‚Ä∫</span>
    </button>

    <div class="collapsible-content" id="promptContent">
      <div class="prompt-text">
        "Create an interactive website (HTML file only) to teach how <strong>training data size affects AI model performance</strong> in healthcare. The tool should teach learners that more training data leads to better model accuracy and more reliable predictions.
        <br><br>
        The tool should simulate training a disease prediction model with varying sample sizes (100 to 10,000 patients). Learners should move a slider and observe how model accuracy increases from 68% (100 patients) to 93% (10,000 patients), while confidence intervals narrow from ¬±8% to ¬±1.5%.
        <br><br>
        The visualization should show a learning curve chart with training set size on the x-axis and accuracy on the y-axis, with a shaded confidence interval band that narrows as sample size increases. Display current metrics prominently: training set size, model accuracy, and confidence interval width.
        <br><br>
        Keep it simple: one slider, one chart, three metrics. No wearable data, no data tables, no biomarkers‚Äîjust the core statistical concept.
        <br><br>
        The key learning: small training sets lead to unreliable models; large training sets enable accurate, trustworthy AI for clinical use."
      </div>
    </div>
  </div>
</div>

<script>
const canvas = document.getElementById('learningCurve');
const ctx = canvas.getContext('2d');
const sizeSlider = document.getElementById('sizeSlider');

canvas.width = canvas.offsetWidth * window.devicePixelRatio;
canvas.height = canvas.offsetHeight * window.devicePixelRatio;
ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
const width = canvas.offsetWidth;
const height = canvas.offsetHeight;

// Learning curve model: accuracy = asymptote - (asymptote - baseline) * exp(-k * n)
function getAccuracy(n) {
  const asymptote = 93;  // Maximum achievable accuracy
  const baseline = 68;   // Accuracy with minimal data
  const k = 0.0003;      // Learning rate
  return asymptote - (asymptote - baseline) * Math.exp(-k * n);
}

// Confidence interval shrinks with sqrt(n)
function getCI(n) {
  const baseCI = 8;  // CI at n=100
  return baseCI * Math.sqrt(100 / n);
}

function drawLearningCurve(currentSize) {
  ctx.clearRect(0, 0, width, height);

  const padding = { top: 20, right: 20, bottom: 50, left: 60 };
  const plotWidth = width - padding.left - padding.right;
  const plotHeight = height - padding.top - padding.bottom;

  // Grid
  ctx.strokeStyle = '#e9ecef';
  ctx.lineWidth = 1;
  for (let i = 0; i <= 5; i++) {
    const y = padding.top + (plotHeight / 5) * i;
    ctx.beginPath();
    ctx.moveTo(padding.left, y);
    ctx.lineTo(padding.left + plotWidth, y);
    ctx.stroke();
  }

  // Y-axis labels (accuracy)
  ctx.fillStyle = '#6c757d';
  ctx.font = '11px sans-serif';
  ctx.textAlign = 'right';
  [95, 90, 85, 80, 75, 70].forEach((val, i) => {
    const y = padding.top + (plotHeight / 5) * i;
    ctx.fillText(val + '%', padding.left - 10, y + 4);
  });

  // X-axis labels
  ctx.textAlign = 'center';
  [0, 2000, 4000, 6000, 8000, 10000].forEach((val, i) => {
    const x = padding.left + (i / 5) * plotWidth;
    ctx.fillText(val, x, height - 10);
  });

  // Axis titles
  ctx.fillStyle = '#495057';
  ctx.font = '12px sans-serif';
  ctx.fillText('Training Set Size (patients)', padding.left + plotWidth / 2, height - 25);

  ctx.save();
  ctx.translate(15, padding.top + plotHeight / 2);
  ctx.rotate(-Math.PI / 2);
  ctx.textAlign = 'center';
  ctx.fillText('Model Accuracy (%)', 0, 0);
  ctx.restore();

  // Draw confidence band (up to currentSize)
  ctx.fillStyle = 'rgba(52, 152, 219, 0.15)';
  ctx.beginPath();

  const points = [];
  for (let n = 100; n <= currentSize; n += 50) {
    const x = padding.left + ((n / 10000) * plotWidth);
    const acc = getAccuracy(n);
    const ci = getCI(n);
    const yUpper = padding.top + plotHeight * (1 - (acc + ci - 65) / 30);
    const yLower = padding.top + plotHeight * (1 - (acc - ci - 65) / 30);

    points.push({ x, yUpper, yLower });
  }

  // Upper bound
  points.forEach((p, i) => {
    if (i === 0) ctx.moveTo(p.x, p.yUpper);
    else ctx.lineTo(p.x, p.yUpper);
  });

  // Lower bound (reverse)
  for (let i = points.length - 1; i >= 0; i--) {
    ctx.lineTo(points[i].x, points[i].yLower);
  }

  ctx.closePath();
  ctx.fill();

  // Draw accuracy curve (up to currentSize)
  ctx.strokeStyle = '#3498db';
  ctx.lineWidth = 3;
  ctx.beginPath();

  for (let n = 100; n <= currentSize; n += 50) {
    const x = padding.left + ((n / 10000) * plotWidth);
    const acc = getAccuracy(n);
    const y = padding.top + plotHeight * (1 - (acc - 65) / 30);

    if (n === 100) ctx.moveTo(x, y);
    else ctx.lineTo(x, y);
  }
  ctx.stroke();

  // Current position marker
  const currentX = padding.left + ((currentSize / 10000) * plotWidth);
  const currentAcc = getAccuracy(currentSize);
  const currentY = padding.top + plotHeight * (1 - (currentAcc - 65) / 30);

  ctx.fillStyle = '#e74c3c';
  ctx.beginPath();
  ctx.arc(currentX, currentY, 5, 0, Math.PI * 2);
  ctx.fill();

  // Vertical line at current position
  ctx.strokeStyle = '#495057';
  ctx.lineWidth = 1;
  ctx.setLineDash([4, 4]);
  ctx.beginPath();
  ctx.moveTo(currentX, padding.top);
  ctx.lineTo(currentX, padding.top + plotHeight);
  ctx.stroke();
  ctx.setLineDash([]);
}

function updateDashboard() {
  const size = parseInt(sizeSlider.value);
  const accuracy = getAccuracy(size);
  const ci = getCI(size);

  document.getElementById('currentSize').textContent = size.toLocaleString();
  document.getElementById('accuracyValue').textContent = accuracy.toFixed(1) + '%';
  document.getElementById('ciValue').textContent = '¬±' + ci.toFixed(1) + '%';

  // Reliability assessment
  let reliability;
  if (size < 500) {
    reliability = 'Low';
  } else if (size < 2000) {
    reliability = 'Moderate';
  } else {
    reliability = 'High';
  }
  document.getElementById('reliabilityText').textContent = reliability;

  // Insight
  let insight;
  if (size < 500) {
    insight = `With only ${size.toLocaleString()} training samples, the model is unreliable (${accuracy.toFixed(1)}% ¬± ${ci.toFixed(1)}%). High risk of overfitting. Collect more data before deployment.`;
  } else if (size < 2000) {
    insight = `${size.toLocaleString()} samples provides moderate performance (${accuracy.toFixed(1)}% ¬± ${ci.toFixed(1)}%). Model is improving but more data will increase reliability.`;
  } else if (size < 5000) {
    insight = `Strong performance with ${size.toLocaleString()} samples (${accuracy.toFixed(1)}% ¬± ${ci.toFixed(1)}%). Model is reliable for clinical use with acceptable uncertainty.`;
  } else {
    insight = `Excellent performance with ${size.toLocaleString()} samples (${accuracy.toFixed(1)}% ¬± ${ci.toFixed(1)}%). Model achieves high accuracy with low uncertainty‚Äîsuitable for production deployment.`;
  }
  document.getElementById('insightBox').textContent = insight;

  drawLearningCurve(size);
}

function toggleDeepDive() {
  const content = document.getElementById('deepDiveContent');
  const arrow = document.getElementById('deepDiveArrow');
  content.classList.toggle('visible');
  arrow.classList.toggle('open');
}

function togglePrompt() {
  const content = document.getElementById('promptContent');
  const arrow = document.getElementById('promptArrow');
  content.classList.toggle('visible');
  arrow.classList.toggle('open');
}

sizeSlider.addEventListener('input', updateDashboard);
updateDashboard();
</script>

</body>
</html>